(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[19],{64239:(e,t,s)=>{Promise.resolve().then(s.bind(s,82192))},82192:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var r=s(95155),i=s(12115),a=s(35695),l=s(29911),n=s(26597);function d(){var e;let{id:t}=(0,a.useParams)(),s=(0,a.useRouter)(),d=(0,a.useSearchParams)().get("updated"),[c,o]=(0,i.useState)(null),[x,m]=(0,i.useState)([]),[b,h]=(0,i.useState)(!0),[p,u]=(0,i.useState)(null),[N,j]=(0,i.useState)(!1);(0,i.useEffect)(()=>{t&&Promise.all([fetch("/api/patients/".concat(t)),fetch("/api/patients/".concat(t,"/history"))]).then(async e=>{let[t,s]=e;if(!t.ok)throw Error("Erreur API patient: ".concat(t.status));if(!s.ok)throw Error("Erreur API historique: ".concat(s.status));let r=await t.json(),i=await s.json();o(r),m(i),h(!1),"true"===d&&(j(!0),setTimeout(()=>{window.print()},1e3),setTimeout(()=>{j(!1)},5e3))}).catch(e=>{console.error("Erreur chargement fiche m\xe9dicale:",e),u("Impossible de charger les informations du patient"),h(!1)})},[t,d]);let g=null==c||null==(e=c.diagnosis)?void 0:e.toLowerCase().includes("critique"),f=c?new Date(c.createdAt).toLocaleDateString("fr-FR"):"",v=c&&c.poids&&c.taille?(c.poids/(c.taille*c.taille)).toFixed(1):null;return b?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("p",{children:"Chargement..."})}):p?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center text-red-600",children:(0,r.jsx)("p",{children:p})}):(0,r.jsxs)("div",{className:"min-h-screen p-6 print:p-0 bg-white text-black",children:[(0,r.jsxs)("header",{className:"hidden print:flex justify-between items-center border-b-2 border-blue-800 pb-4 mb-6",children:[(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-blue-900",children:"CENTRE HOSPITALIER UNIVERSITAIRE"}),(0,r.jsx)("p",{className:"text-gray-700",children:"Service de M\xe9decine G\xe9n\xe9rale"})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"font-bold",children:"UAC-IFRI-GL-2025"}),(0,r.jsx)("p",{children:"00229 Abomey-Calavi"}),(0,r.jsx)("p",{children:"T\xe9l: +229 XX XX XX XX"})]})]}),N&&(0,r.jsxs)("div",{className:"fixed top-4 right-4 bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded shadow-md flex items-center space-x-2 no-print z-50",children:[(0,r.jsx)(l.A7C,{}),(0,r.jsx)("span",{children:"Fiche mise \xe0 jour ! Impression en cours..."})]}),(0,r.jsxs)("div",{className:"max-w-4xl mx-auto print:max-w-full",children:[(0,r.jsxs)("div",{className:"flex justify-between mb-6 no-print",children:[(0,r.jsxs)("button",{onClick:()=>s.back(),className:"flex items-center text-blue-800 hover:underline print:hidden",children:[(0,r.jsx)(l.QVr,{className:"mr-2"})," Retour"]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("button",{onClick:()=>window.print(),className:"bg-gray-700 text-white px-4 py-2 rounded flex items-center print:hidden",children:[(0,r.jsx)(l.n4o,{className:"mr-2"})," Imprimer"]}),(0,r.jsxs)("button",{onClick:()=>{if(!c)return;let e=new n.Ay;if(e.setFontSize(18),e.text("FICHE MEDICALE PATIENT",14,20),e.setFontSize(14),e.text("IDENTIT\xc9 DU PATIENT",14,30),e.setFontSize(12),e.text("Nom complet: ".concat(c.name),14,38),e.text("Date cr\xe9ation: ".concat(f),14,44),e.text("\xc2ge/Sexe: ".concat(c.age," ans / ").concat(c.sexe||"NR"),14,50),e.text("N\xb0 S\xe9curit\xe9 Sociale: ".concat(c.numSecu||"Non renseign\xe9"),14,56),e.setFontSize(14),e.text("PARAM\xc8TRES M\xc9DICAUX",14,66),e.setFontSize(12),e.text("Taille/Poids: ".concat(c.taille?"".concat(c.taille," m"):"NR"," / ").concat(c.poids?"".concat(c.poids," kg"):"NR"),14,74),v&&e.text("IMC: ".concat(v," kg/m\xb2"),14,80),e.text("M\xe9decin traitant: Dr ".concat(c.medecin||"Non d\xe9sign\xe9"),14,86),e.setFontSize(14),e.text("DIAGNOSTIC PRINCIPAL",14,96),e.setFontSize(12),e.text(c.diagnosis,14,104),e.setFontSize(14),e.text("TRAITEMENT PRESCRIT",14,114),e.setFontSize(12),c.traitement){let t=e.splitTextToSize(c.traitement,180);e.text(t,14,122)}else e.text("Aucun traitement enregistr\xe9",14,122);if(e.setFontSize(14),e.text("RECOMMANDATIONS",14,142),e.setFontSize(12),c.traitement?(e.text("• Suivi m\xe9dical r\xe9gulier obligatoire",14,150),e.text("• Respect strict de la posologie prescrite",14,156),e.text("• Consultation imm\xe9diate en cas d aggravation",14,162),g&&e.text("• Surveillance continue n\xe9cessaire",14,168)):e.text("Aucune recommandation sp\xe9cifique",14,150),x.length>0){e.setFontSize(14),e.text("HISTORIQUE M\xc9DICAL",14,180);let t=[];x.forEach(e=>{let s=[new Date(e.dateConsultation).toLocaleDateString("fr-FR"),e.motif,e.observations||"-",e.prescription||"-"];t.push(s)}),e.autoTable({startY:185,head:[["Date","Motif","Observations","Prescription"]],body:t,styles:{fontSize:10},headStyles:{fillColor:[41,128,185]}})}e.setFontSize(10),e.text("\xc9dit\xe9e le: ".concat(new Date().toLocaleDateString("fr-FR")),14,e.internal.pageSize.height-20),e.text("Par: Dr ".concat(c.medecin||"M\xe9decin non sp\xe9cifi\xe9"),14,e.internal.pageSize.height-14),e.text("Document m\xe9dical confidentiel",14,e.internal.pageSize.height-8),e.save("Fiche_Medicale_".concat(c.name.replace(/ /g,"_"),".pdf"))},className:"bg-red-700 text-white px-4 py-2 rounded flex items-center print:hidden",children:[(0,r.jsx)(l.kl1,{className:"mr-2"})," G\xe9n\xe9rer PDF"]})]})]}),(0,r.jsxs)("div",{className:"text-center mb-8 border-b-2 border-blue-800 pb-4",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-blue-900 mb-2",children:"FICHE MEDICALE PATIENT"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["N\xb0 Dossier: ",null==c?void 0:c.id]})]}),g&&(0,r.jsxs)("div",{className:"mb-6 p-3 bg-red-100 border-l-4 border-red-500 rounded flex items-center print:bg-red-50",children:[(0,r.jsx)(l.BS8,{className:"text-red-600 mr-2 text-xl"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold text-red-700",children:"URGENCE MEDICALE"}),(0,r.jsx)("p",{className:"text-sm",children:"Prise en charge prioritaire requise"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,r.jsxs)("div",{className:"border border-gray-300 rounded p-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4 pb-2 border-b border-blue-200",children:"IDENTIT\xc9 DU PATIENT"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"w-40 font-semibold",children:"Nom complet:"}),(0,r.jsx)("span",{className:"border-b border-dotted border-gray-400 flex-1",children:null==c?void 0:c.name})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"w-40 font-semibold",children:"Date cr\xe9ation:"}),(0,r.jsx)("span",{children:f})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"w-40 font-semibold",children:"\xc2ge/Sexe:"}),(0,r.jsxs)("span",{children:[null==c?void 0:c.age," ans / ",(null==c?void 0:c.sexe)||"NR"]})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"w-40 font-semibold",children:"N\xb0 S\xe9curit\xe9 Sociale:"}),(0,r.jsx)("span",{className:"border-b border-dotted border-gray-400 flex-1",children:(null==c?void 0:c.numSecu)||"Non renseign\xe9"})]})]})]}),(0,r.jsxs)("div",{className:"border border-gray-300 rounded p-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4 pb-2 border-b border-blue-200",children:"PARAM\xc8TRES M\xc9DICAUX"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"w-40 font-semibold",children:"Taille/Poids:"}),(0,r.jsxs)("span",{children:[(null==c?void 0:c.taille)?"".concat(c.taille," m"):"NR"," / ",(null==c?void 0:c.poids)?"".concat(c.poids," kg"):"NR"]})]}),v&&(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"w-40 font-semibold",children:"IMC:"}),(0,r.jsxs)("span",{children:[v," kg/m\xb2"]})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"w-40 font-semibold",children:"M\xe9decin traitant:"}),(0,r.jsxs)("span",{children:["Dr ",(null==c?void 0:c.medecin)||"Non d\xe9sign\xe9"]})]})]})]})]}),(0,r.jsxs)("div",{className:"border border-gray-300 rounded p-4 mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4 pb-2 border-b border-blue-200",children:"DIAGNOSTIC PRINCIPAL"}),(0,r.jsx)("div",{className:"p-3 rounded ".concat(g?"bg-red-50 border-l-4 border-red-500":"bg-gray-50"),children:(0,r.jsx)("p",{className:g?"font-bold text-red-700":"",children:null==c?void 0:c.diagnosis})})]}),(0,r.jsxs)("div",{className:"border border-gray-300 rounded p-4 mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4 pb-2 border-b border-blue-200",children:"TRAITEMENT PRESCRIT"}),(0,r.jsx)("div",{className:"bg-gray-50 p-3 rounded",children:(null==c?void 0:c.traitement)?(0,r.jsx)("div",{className:"whitespace-pre-line",children:c.traitement}):(0,r.jsx)("p",{className:"italic text-gray-500",children:"Aucun traitement enregistr\xe9"})})]}),(0,r.jsxs)("div",{className:"border border-gray-300 rounded p-4 mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4 pb-2 border-b border-blue-200",children:"RECOMMANDATIONS"}),(0,r.jsx)("div",{className:"space-y-2",children:(null==c?void 0:c.traitement)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:"• Suivi m\xe9dical r\xe9gulier obligatoire"}),(0,r.jsx)("p",{children:"• Respect strict de la posologie prescrite"}),(0,r.jsx)("p",{children:"• Consultation imm\xe9diate en cas d aggravation"}),g&&(0,r.jsx)("p",{className:"font-bold text-red-700",children:"• Surveillance continue n\xe9cessaire"})]}):(0,r.jsx)("p",{className:"italic text-gray-500",children:"Aucune recommandation sp\xe9cifique"})})]}),(0,r.jsxs)("div",{className:"border border-gray-300 rounded p-4 mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4 pb-2 border-b border-blue-200",children:"HISTORIQUE M\xc9DICAL"}),0===x.length?(0,r.jsx)("p",{className:"italic text-gray-500",children:"Aucun historique m\xe9dical disponible"}):(0,r.jsxs)("table",{className:"w-full border-collapse border border-gray-300 text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-blue-100",children:[(0,r.jsx)("th",{className:"border border-gray-300 p-2 text-left",children:"Date"}),(0,r.jsx)("th",{className:"border border-gray-300 p-2 text-left",children:"Motif"}),(0,r.jsx)("th",{className:"border border-gray-300 p-2 text-left",children:"Observations"}),(0,r.jsx)("th",{className:"border border-gray-300 p-2 text-left",children:"Prescription"})]})}),(0,r.jsx)("tbody",{children:x.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"border border-gray-300 p-2",children:new Date(e.dateConsultation).toLocaleDateString("fr-FR")}),(0,r.jsx)("td",{className:"border border-gray-300 p-2",children:e.motif}),(0,r.jsx)("td",{className:"border border-gray-300 p-2",children:e.observations||"-"}),(0,r.jsx)("td",{className:"border border-gray-300 p-2",children:e.prescription||"-"})]},e.id))})]})]}),(0,r.jsx)("footer",{className:"border-t-2 border-blue-800 pt-4 text-sm text-gray-700 print:mt-8",children:(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:["\xc9dit\xe9e le: ",new Date().toLocaleDateString("fr-FR")]}),(0,r.jsxs)("p",{children:["Par: Dr ",(null==c?void 0:c.medecin)||"M\xe9decin non sp\xe9cifi\xe9"]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"font-bold",children:"Document m\xe9dical confidentiel"}),(0,r.jsx)("p",{children:"Signature et cachet du m\xe9decin:"}),(0,r.jsx)("div",{className:"mt-8 border-t border-gray-400 w-48 ml-auto pt-2",children:(0,r.jsx)("p",{className:"text-center text-xs",children:"Cachet et signature"})})]})]})})]})]})}s(76118)}},e=>{var t=t=>e(e.s=t);e.O(0,[711,930,173,441,684,358],()=>t(64239)),_N_E=e.O()}]);